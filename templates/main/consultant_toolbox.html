<ion-view  class="common-person-view">




<ion-content ng-switch on="consultant.win">


       <ion-refresher
              refreshing-text="数据正在加载中..."
              pulling-icon="ion-ios-arrow-down"
              spinner="bubbles"
              pulling-text="下拉刷新"
              on-refresh="doRefresh()">
      </ion-refresher>


<!-- index -->
<div class="main1" ng-switch-when='index'>

  

<div class="gnr2dadv"><!--内容右侧开始-->
      <div class="gjxnrtopyy"></div>
            
                <div class="gnr2ma"> 
       

                   <div class="khzlzz1">
                      <div class="khzlzz1a"><span>{{data.profile.data.fullname}}，您好！</span> 
                        <a href="" ng-click="updateProfile(1)" ng-if="!enableUpdatedProfile(1)">完善资料</a>
                        <a href="" ng-click="cancelUpdateProfile(1)" ng-if="enableUpdatedProfile(1)">取消</a>
                      </div>
                      <div class="khzlzz1b">
                      
                         <div class="khzlzz1bf">
                            <div class="khzlzz1bfimg" ng-if="!enableUpdatedProfile(1)"><img ng-src="{{imgProfile.data}}" /></div>
                            <div class="khzlzz1bfimg" ng-if="enableUpdatedProfile(1)"> <img ng-src="{{imgProfile.data}}" ng-click="choosePicMenu()"/></div>

                            <div ng-if="!enableUpdatedProfile(1)" class="khzlzz1bfw">{{data.profile.data.fullname}}</div>
                            <input ng-if="enableUpdatedProfile(1)" class="khzlzz1bfwu" placeholder="请输入姓名" ng-model="data.update.fullname"/>
                          
                         </div>
                         <div class="khzlzz1br">
                            <div class="khzlzz1br1"><span>邮 箱</span>
                              <div ng-if="!enableUpdatedProfile(1)">{{data.profile.data.email}}</div>
                              <input ng-if="enableUpdatedProfile(1)" placeholder="请输入您的邮箱地址" ng-model="data.update.email"/>
                            </div>

                            <div class="khzlzz1br2"><span>性 别</span>
                              <div ng-if="!enableUpdatedProfile(1)">{{data.profile.data.gender | genderFilter}}</div>
                              <div ng-if="enableUpdatedProfile(1)">
                                   <select style="width:100%;border:0.1rem;" placeholder="请选择性别" ng-model="data.update.gender">
                                   <option value='male'>男</option>
                                   <option value='female'>女</option>
                                   </select>
                              </div>
                            </div>

                            <div class="khzlzz1br2"><span>手机号码</span><div>{{data.profile.data.phone}}</div></div>
                            <div class="khzlzz1br2"><span>推 荐 码</span><div>{{data.profile.data.barcode}}</div></div>

                            <div class="khzlzz1br2"><span>所 在 地</span>
                              <div ng-if="!enableUpdatedProfile(1)">{{data.profile.data.province | provinceFilter}}</div>
                              <div ng-if="enableUpdatedProfile(1)">
                                   <select style="width:100%;border:0.1rem;" placeholder="请选择所在地" ng-model="data.update.province">
                                    <option ng-repeat='p in provinceNames' value={{p.key}}>{{p.value}}</option>
                                   </select>
                              </div>
                            </div>

                         </div>


                        
                         
                      </div>
                   </div>
                   
                   
                   
                   <div class="khzlzz3a11">
                      <div class="khzlzz2b1">
                          <div class="khzlzz2bf1">背  景</div> 
                          <div ng-if="!enableUpdatedProfile(1)"  class="khzlzz2br1">{{data.profile.data.background}}
</div>
                          
                          <textarea type="text" ng-if="enableUpdatedProfile(1)" class="khzlzz2br7u" ng-model="data.update.background"></textarea>
                       </div>
                       <div ng-if="!enableUpdatedProfile(1)" class="khzlzz2c">
                          <div class="khzlzz2cf1">职业证书</div> 
                          <ul class="khzlzz2cr1">
                             <li ng-repeat="cert in data.profile.data.certs"><img src="{{cert | certImageFilter}}" /></li>
                             <!--<li><img src="teImg/zslog.jpg" /></li>
                             <li><img src="teImg/zslog2.jpg" /></li>
                             <li><img src="teImg/zslog3.jpg" /></li>
                             <li><img src="teImg/zslog4.jpg" /></li>-->
                          </ul>
                       </div>


                       <div ng-if="enableUpdatedProfile(1)" class="khzlzz2c">
                          <div class="khzlzz2cf1">职业证书</div> 
                          <div class="khzlzz2br7u11">
                            <label ng-repeat="cert1 in ['cpb', 'afp', 'cfp', 'efp']" ng-if="enableNewCert(cert1)">
                              <input name="{{cert1}}" type="checkbox" ng-model="tmpCerts[cert1]"/>{{cert1}} 
                            </label>
                            <!--
                            <label><input name="CPB" type="checkbox" value="1" ng-model='data.update.cpb'/>CPB </label>
                            <label><input name="AFP" type="checkbox" value="2" ng-model='data.update.afp'/>AFP </label>
                            <label><input name="CFP" type="checkbox" value="3" ng-model='data.update.cfp'/>CFP </label>
                            <label><input name="EFP" type="checkbox" value="4" ng-model='data.update.efp'/>EFP </label>-->
                          </div>
                       </div>

                       <div class="khzlzz2c">
                          <div class="khzlzz2cf1">待审核</div> 
                          <ul class="khzlzz2cr1">
                             <li ng-repeat="c2 in data.profile.data.newCerts"><img src="{{c2 | certImageFilter}}" /></li>
                             <!--<li><img src="teImg/zslog.jpg" /></li>
                             <li><img src="teImg/zslog2.jpg" /></li>
                             <li><img src="teImg/zslog3.jpg" /></li>
                             <li><img src="teImg/zslog4.jpg" /></li>-->
                          </ul>
                       </div>



                   </div>

                   <input type="submit" ng-if="enableUpdatedProfile(1)" value="确认修改" class="khzlqdqd" ng-click="updateProfileInformation(data.update)"/>



                   <div class="khzlzz3a"><span>我的密码</span> 
                    <a href="" ng-click="updateProfile(3)" ng-if="!enableUpdatedProfile(3)">修改</a>
                    <a href="" ng-click="cancelUpdateProfile(3)" ng-if="enableUpdatedProfile(3)">取消</a>
                   </div>



                   <div ng-if="enableUpdatedProfile(3)">
                    
                     <div class="khzlzz3a1">
                         <span>新 密 码</span>
                         <!--<div>8-20位，必须含有字母</div>-->
                         <input type='password' placeholder="请设置您的新密码" ng-model="modify.password1" />
                     </div>
                     <div class="khzlzz3a1">
                         <span>确认新密码</span>
                         <input type='password' placeholder="请重复输入您的密码" ng-model="modify.password2"/>
                     </div>
                     <div class="khzlzz3a1">
                         <span>手 机 号</span>
                         <input placeholder="请输入您的手机号码" ng-model="data.profile.data.phone"/>
                     </div>
                     <div class="khzlzzyzm">
                         <span>验 证 码</span>
                         <input value=""  placeholder="请输入验证码" ng-model="modify.code"/>
                         <a ng-if="modify.verify=='获取验证码'" href="" ng-click="getModifyVerifyCode(data.profile.data.phone)">{{modify.verify}}</a>
                         <a ng-if="modify.verify!='获取验证码'" href="">{{modify.verify}}</a>  
                     </div>
                     <input ng-if="modify.enabled" type="submit" value="确定" class="khzlqdqd" 
                     ng-click="modifyPassword(data.profile.data.phone, modify.code, data.profile.data.username,
                     modify.password1, modify.password2)"/>
                    
                   </div>



                    <div class="khzlzz3a"><span>佣金显示</span> 
                   </div>
                   <div>
                    <ion-toggle toggle-class="toggle-assertive"
                      ng-model="data.commissionCtrl.enabled" style="font-size: 0.3rem; color: #395983;">
                    <i>开关</i>
                   </ion-toggle>   

                   </div>

              </div>
              
            </div><!--内容右侧结束-->

 
</div>
<!-- index -->


<!-- CRM -->    
<div class="main1" ng-switch-when='customers'>
  <div class="gnr2dadv"><!--内容右侧开始-->

              <div class="gjxnrtpyyre">  
                  <div class="khlbtop"><!--内容top开始--> 
                  
                       <div class="sekkgdvbb">
                         <select class="kkxxbbsele" ng-model="data.selectedGroup" ng-change="changeGroup(data.selectedGroup)"> 
                            <option value="all">默认分组</option>
                            <option ng-repeat="group in data.groups" value="{{group}}">{{group}}</option>
                         </select> 
                         <a class="aakhbb2" href=""></a> 
                       </div> 
                      <!--
                      <div class="khlbpr">
                        <form>
                             <input type="text"  class="khlbprput" placeholder="请输入客户的姓名"/>
                             <input type="submit" class="khlbprtj" value="" />
                        </form>
                      </div> -->
                  </div><!--内容top结束-->


                </div>  
                
                
                <!--1021修改-->
          
                <div class="lbxzxzdv" style="margin-top:1.5rem">
                    <ion-list>
                    <!---->
                      <ion-item class="twtwdvkh" ng-repeat="customer in data.customers.data"  ng-click="goCustomerHistory(customer)"> <!-- -->
                          <div class="khtwtwdvf"><img ng-src="{{customer | imageCustomerFilter}}" /></div>
                          <div class="khtwdvr">
                            <p class="khtwrp1"><span>{{customer.fullname}}</span> <em>所在地：上海</em></p>
                            <p class="khtwrp2"><span>电话：{{customer.phone}}</span> <em>邮箱：{{customer.email}}</em></p>
                          </div>
                          <ion-option-button class="button-energized" ng-click="group(customer)">
                            分组 
                          </ion-option-button>
                          <!--
                          <ion-option-button class="button-assertive">
                            删除 
                          </ion-option-button>-->
                      </ion-item>
                    </ion-list>

                </div>
             
                <!--1021修改-->
  
     
  </div><!--内容右侧结束-->
</div>



<!-- orders -->
<div class="main1" ng-switch-when='orders'>
            <div class="gnr2dadv"><!--内容右侧开始-->

                <div class="gjxnrtopyy"></div>
                <!-- 内容top阴影 -->

                <div class="gnr2ma"> 
                  <!--修改新增部分-s-->
                    
                   <div class="khzlzz3a"><span>认购，申购</span> 
                    <a href="" ng-click="selectPage('orders', 'all'); selectOrders('all');" ng-if="showContent('orders', 'todo')">
                      查看全部
                    </a>
                    <a href="" ng-click="selectPage('orders', 'todo');  selectOrders('todo');"  ng-if="showContent('orders', 'all')">
                    查看未完成
                    </a>
                   </div>
                  
                <div>
              
                  <!--<ion-spinner icon="lines" style="position: absolute;display: block; left: 50%;" ng-if="data.refreshing.orders"></ion-spinner>-->
                </div>

                  <ion-list>
                    <ion-item class="lcsslwsl" ng-repeat="order in data.currentOrder.data" ng-click="goOrderDetail(order.id)">
                       <div class="lcsslwslf1">
                        <img ng-cache ng-src="{{order.customer | imageCustomerFilter}}" /> 
                        <span>{{order.customer.fullname}}</span>
                      </div>
                       <div class="lcsslwslf1"><img ng-src='{{data.productType[order.product.type.toLowerCase()].image}}' /> <span>{{data.productType[order.product.type.toLowerCase()].name}}</span></div>
                       <span class="lccslwf2tyson">{{order.product.name}}</span>
                       <div class="lcssr3b">
                        <img src="teImg/ytj11.png" ng-if="order.state.toLowerCase()!='completed'"/>
                        <img src="teImg/ywc11.png" ng-if="order.state.toLowerCase()=='completed'"/>
                       </div>
                       <!--
                       <ion-option-button class="button-energized">
                            投诉 
                       </ion-option-button>-->
                    </ion-item>

                  </ion-list> 

                    
                    <!--
                    <div class="twtwdv" ng-repeat="order in data.currentOrder.data" ng-click="goOrderDetail(order.id)">
                        <div class="twtwdvf"><img src='{{data.orderState[order.state.toLowerCase()].image}}' /> <em>{{data.orderState[order.state.toLowerCase()].name}}</em> </div>
                        <span>[{{data.productType[order.product.type.toLowerCase()].name}}] {{order.product.issuer}}</span>
                    </div>   
                    
                    <div class="twtwdv">
                        <div class="twtwdvf"><img src='teImg/gnr2rabm3.png' /></div>
                        <span>[私募]粤财·瀚信中鼎盈丰2期</span>
                    </div>-->
         
            </div>
      </div>
</div>
<!-- orders -->

<!-- bookings -->
<div class="main1" ng-switch-when='bookings'>
    <div class="gnr2dadv"><!--内容右侧开始-->

                <div class="gjxnrtopyy"></div>
                <!-- 内容top阴影 -->

                <div class="gnr2ma"> 

                  

                   <div class="khzlzz3a"><span>咨询，预约</span> 
                    <a href="" ng-click="selectPage('bookings','all');  selectBookings('all')" ng-if="showContent('bookings', 'todo')">
                      查看全部
                    </a>
                    <a href="" ng-click="selectPage('bookings','todo'); selectBookings('todo')" ng-if="showContent('bookings','all')">
                      查看未处理
                    </a>
                   </div>

                   <!--<ion-spinner icon="lines" style="position: absolute;display: block; left: 50%;" ng-if="data.refreshing.bookings"></ion-spinner>-->
                  <ion-list>

                    <ion-item class="lcsslwsl" ng-repeat="booking in data.currentBooking.data" ng-click="goBookingDetail(booking.id)">
                       <div class="lcsslwslf1">
                        <img ng-src="{{booking.customer | imageCustomerFilter}}" /> 
                        <span>{{booking.customer.fullname}}</span>
                       </div>
                       <div class="lcsslwslf1"><img src='{{data.productType[booking.product.type.toLowerCase()].image}}' /> <span>{{data.productType[booking.product.type.toLowerCase()].name}}</span></div>
                       <span class="lccslwf2tyson">{{booking.product.name}}</span>
                       <div class="lcssr3" ng-if="booking.state!='completed'"><img src="teImg/wfw11.png" /></div>
                       <div class="lcssr3" ng-if="booking.state=='completed'"><img src="teImg/yfw11.png" /></div>
                       <!--<ion-option-button class="button-energized">
                            投诉 
                          </ion-option-button>-->
                    </ion-item>

                  

                  </ion-list> 
                  <!--
                   <div class="twtwdv" ng-repeat="booking in data.bookings['all'].data" ng-click="showProduct(booking.product, 'NoBooking')">
                        <div class="twtwdvf"><img src='{{data.bookingState[booking.state.toLowerCase()].image}}' /> <em>{{data.bookingState[booking.state.toLowerCase()].name}}</em> </div>
                        <span>[{{data.productType[booking.product.type.toLowerCase()].name}}] {{booking.product.issuer}}</span>
                    </div>  --> 

              </div>
         
    </div><!--内容右侧结束-->
</div>
<!-- bookings --> 


<!-- fav -->
<div class="main1" ng-switch-when='like'>
    <div class="gnr2dadv"><!--内容右侧开始-->

                <div class="gjxnrtopyy"></div>
                <!-- 内容top阴影 -->

                <div class="gnr2ma"> 

                  <ion-list>

                    <ion-item class="lcsslwsl" ng-repeat="product in data.liked.data" ng-click="showProduct(product)">
                       <div class="lcsslwslf1"><img src='{{data.productType[product.type.toLowerCase()].image}}' /> <span>{{data.productType[product.type.toLowerCase()].name}}</span></div>
                       <span class="lccslwf2">{{product.name}}</span>
                          <ion-option-button class="button-assertive" ng-click="hateIt(product)">
                            删除
                          </ion-option-button>
                    </ion-item>

                  </ion-list> 
                  <!--
                   <div class="twtwdv" ng-repeat="booking in data.bookings['all'].data" ng-click="showProduct(booking.product, 'NoBooking')">
                        <div class="twtwdvf"><img src='{{data.bookingState[booking.state.toLowerCase()].image}}' /> <em>{{data.bookingState[booking.state.toLowerCase()].name}}</em> </div>
                        <span>[{{data.productType[booking.product.type.toLowerCase()].name}}] {{booking.product.issuer}}</span>
                    </div>  --> 

              </div>
         
    </div><!--内容右侧结束-->
</div>
<!-- fav -->




<!-- message -->
<div class="main1" ng-switch-when='message'>
  <div class="gnr2dadv"><!--内容右侧开始-->

                <div class="gjxnrtopyy"></div><!-- 内容top阴影 -->
                <div class="gnr2ma">
              
               <!--
                <ul class="grxxrzpul">
                   <li class="zhyhkpulcss"><a href="">业务通知</a></li>
                   <li><a href="">系统消息</a></li>
                </ul>-->
                
                <!--<a href="" class="grxzxzaa">系统消息</a>-->
                <div style="height:0.1rem;"></div>
               
                <ion-list>
                    <ion-item class="lcsslwsl" ng-click="messageDialog(msg)" ng-repeat="msg in data.messages">
                       <div class="lcsslwslf1"><img ng-src="{{msg | imageMsgFilter}}"/></div>
                       <span  class="lccslwf2">{{msg.title}}</span>
                       <ion-option-button class="button-energized" ng-click="deleteMsg(msg.id)">
                            删除 
                        </ion-option-button>
                    </ion-item>
                    <!--
                    <ion-item class="lcsslwsl" ng-click="messageDialog()">
                       <div class="lcsslwslf1"><img src="teImg/grrexzimg2.png" /></div>
                       <span  class="lccslwf2">[预约成功]粤财·瀚信中鼎盈丰2期！</span>
                       <ion-option-button class="button-energized">
                            删除
                        </ion-option-button>
                    </ion-item>-->

                  </ion-list> 

                  </div>
                
  </div><!--内容右侧结束-->
</div>
<!-- message -->


<!-- group -->
<div class="main1" ng-switch-when='group'>
    <div class="gnr2dadv"><!--内容右侧开始-->
      
      <div class="gnr2ma"> <!--内容主体开始-->
        <ul class="gnr2lbul" style="margin-top:0.1rem">
            <li><img src="teImg/ghnr1lef.png" /><span>王海</span> <em>new</em></li>
            <li><img src="teImg/ghnr1lef.png" /><span>王海</span> <em>new</em></li>
                     
        </ul>              
      </div><!--内容主体结束-->

  </div>
</div>
<!-- group -->


<!-- investment -->
<div class="main1" ng-switch-when='investment'>
            <div class="gnr2dadv"><!--内容右侧开始-->
                <div class="gjxnrtopyy"></div>
                <div class="gnr2ma"> 

                   <div class="khzlzz3a"><span>个人认购，申购</span> 
                   </div>
                  
                  <ion-list>
                    <ion-item class="lcsslwsl" ng-repeat="order in data.investments.data" ng-click="goOrderDetail(order.id)">
                       <div class="lcsslwslf1">
                        <img ng-cache ng-src="{{order.customer | imageCustomerFilter}}" /> 
                        <span>{{order.customer.fullname}}</span>
                      </div>
                       <div class="lcsslwslf1"><img ng-src='{{data.productType[order.product.type.toLowerCase()].image}}' /> <span>{{data.productType[order.product.type.toLowerCase()].name}}</span></div>
                       <span class="lccslwf2tyson">{{order.product.name}}</span>
                       <div class="lcssr3b">
                        <img src="teImg/ytj11.png" ng-if="order.state.toLowerCase()!='completed'"/>
                        <img src="teImg/ywc11.png" ng-if="order.state.toLowerCase()=='completed'"/>
                       </div>
                       <!--
                       <ion-option-button class="button-energized">
                            投诉 
                       </ion-option-button>-->
                    </ion-item>

                  </ion-list> 
            </div>
      </div>
</div>
<!-- investment -->




<!-- commissions -->
<div class="main1" ng-switch-when='commissions'>
            <div class="gnr2dadv"><!--内容右侧开始-->
              <!--
              <div class="gzghp1">
                 <span>佣金</span>
                 <em></em>
              </div>-->
              

                  <div class="lbxzxzdv">
                    <ion-list>
                      <ion-item class="twtwdvkh" ng-repeat="c in data.commissions" ng-click="goOrderDetail(c.orderId)">

                          <div class="ssetjdv">
                            <div class="ssejtv1">
                               <span>客户：{{c.username}} </span>
                               <em>交易号：{{c.orderId}}</em>
                            </div>
                            
                            <div class="ssejtvb">
                               <span>佣金：<em>{{c.commission}}</em></span>
                               <span>返佣状态：<em>{{c | commissionStateFilter}}</em></span>
                               <p>日期：{{c.timestamp | date:'yyyy-MM-dd  HH:mm:ss'}} </p>
                            </div>
                            
                         </div>
                         
                          <ion-option-button class="button-energized" ng-click="withdrawCommission(c)" ng-if="c.state=='create'">
                            申请提现 
                          </ion-option-button>
                          <!--
                          <ion-option-button class="button-assertive">
                            删除 
                          </ion-option-button>-->
                      </ion-item>
                    </ion-list>
                  </div>


                

              
            </div><!--内容右侧结束-->
</div>
<!-- commissions -->


  </ion-content>
  <multiple-views-support width="75%" />
</ion-view>

